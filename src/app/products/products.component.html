<mat-card>
  <h2 mat-dialog-title *ngIf="isDialog">Товари</h2>
  <mat-card-content>
    <mat-toolbar>
      <mat-form-field class="search">
        <mat-label>Пошук</mat-label>
        <input
          matInput
          type="search"
          [(ngModel)]="searchText"
          (input)="search()"
        />
        <button
          *ngIf="searchText"
          matSuffix
          mat-icon-button
          aria-label="Очистити"
          (click)="searchText = ''; search()"
        >
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>
      <button
        mat-raised-button
        matTooltip="Додати новий товар"
        (click)="addNew()"
      >
        <mat-icon>add</mat-icon>
        Додати
      </button>
    </mat-toolbar>
    <div class="table-wrapper">
      <table mat-table class="full-width-table" matSort>
        <!-- Name Column -->
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Назва</th>
          <td
            *matCellDef="let row"
            [routerLink]="isDialog ? null : '/products/' + row._id"
            class="clickable"
            (click)="onRowClicked(row)"
          >
            {{ row.name }}
          </td>
        </ng-container>
        <!-- Price Column -->
        <ng-container matColumnDef="price">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Ціна</th>
          <td *matCellDef="let row">
            {{ row.price }}
          </td>
        </ng-container>
        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Опис</th>
          <td *matCellDef="let row">
            {{ row.description }}
          </td>
        </ng-container>
        <!-- Category Column -->
        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Категорія</th>
          <td
            *matCellDef="let row"
            [routerLink]="
              row.category?._id && !isDialog
                ? '/categories/' + row.category._id
                : null
            "
            [class]="isDialog ? '' : 'clickable'"
          >
            {{ row.category?.name }}
          </td>
        </ng-container>
        <!-- Article Column -->
        <ng-container matColumnDef="article">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Артикул</th>
          <td *matCellDef="let row">
            {{ row.article }}
          </td>
        </ng-container>
        <!-- Stock Column -->
        <ng-container matColumnDef="stock">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Кількість</th>
          <td *matCellDef="let row">
            {{ row.stock }}
          </td>
        </ng-container>
        <!-- Size Column -->
        <ng-container matColumnDef="size">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>Розмір</th>
          <td *matCellDef="let row">
            {{ row.size }}
          </td>
        </ng-container>

        <tr
          mat-header-row
          *matHeaderRowDef="displayedColumns; sticky: true"
        ></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>

    <mat-paginator
      #paginator
      [length]="dataSource.length"
      [pageIndex]="0"
      [pageSize]="10"
      [pageSizeOptions]="[5, 10, 20]"
      aria-label="Оберіть сторінку"
    >
    </mat-paginator>
  </mat-card-content>
  <div class="spinner-container" *ngIf="dataSource.loading">
    <mat-spinner></mat-spinner>
  </div>
</mat-card>
